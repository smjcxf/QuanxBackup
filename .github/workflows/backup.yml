name: Backup Automatically
on:
  schedule:
    - cron: '0 */2 * * *'
  workflow_dispatch:
jobs:
  backup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source repository QxScript
        uses: actions/checkout@v2
        with:
          repository: xiaomaoJT/QxScript
          path: source-QxScript
      - name: Checkout source repository ios_rule_script
        uses: actions/checkout@v2
        with:
          repository: blackmatrix7/ios_rule_script
          path: source-ios_rule_script
      - name: Checkout target backup repository
        uses: actions/checkout@v2
        with:
          path: target
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Copy QxScript to target directory
        run: cp -r source-QxScript/. target/QxScript/
      - name: Copy ios_rule_script to target directory
        run: cp -r source-ios_rule_script/. target/ios_rule_script/
      - name: Commit and Push changes
        run: |
          cd target
          git config --global user.email "you@example.com"
          git config --global user.name "Your Name"
          git add .
          git commit -m "Automated backup"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
